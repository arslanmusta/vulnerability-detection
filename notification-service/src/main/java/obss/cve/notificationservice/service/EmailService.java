package obss.cve.notificationservice.service;

import obss.cve.notificationservice.domain.Config;
import obss.cve.notificationservice.repository.ConfigRepository;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
public class EmailService {

    private final ConfigRepository configRepository;

    public EmailService(ConfigRepository configRepository) {
        this.configRepository = configRepository;
    }

    public List<String> all() {
        String result = configRepository.findById("email").orElse(new Config("email", "")).getValue();

        String[]  emails = result.split(",", 0);

        if (emails[0].equals("")) {
            return List.of();
        }

        return List.of(emails);
    }

    public List<String> update(List<String> emails) {
        configRepository.save(new Config("email", String.join(",", emails)));
        return emails;
    }
}
