package obss.cve.vulnerableupdateworker.domain;

import org.springframework.stereotype.Component;
import org.w3c.dom.Node;

@Component
public class CpeItemFactory {

    public CpeItem CreateFromNode(Node node) {
        String[] cpeName = node.getAttributes().getNamedItem("name").getNodeValue().split(":");
        String vendor = cpeName[3];
        String product = cpeName[4];
        String version = cpeName[5];

        CpeItem cpeItem = new CpeItem(new CpeItem.CompositeKey(vendor, product));
        cpeItem.AddVersion(version);

        return cpeItem;
    }
}
