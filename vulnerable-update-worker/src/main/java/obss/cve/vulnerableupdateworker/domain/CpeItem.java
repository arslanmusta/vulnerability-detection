package obss.cve.vulnerableupdateworker.domain;

import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

import java.util.ArrayList;
import java.util.List;

@Document("cpeitems")
public class CpeItem {
    @Id
    private CompositeKey id;

    private List<String> versions;

    public static class CompositeKey {
        private String vendor;
        private String product;

        public CompositeKey(String vendor, String product) {
            this.vendor = vendor;
            this.product = product;
        }

        public String getVendor() {
            return vendor;
        }

        public void setVendor(String vendor) {
            this.vendor = vendor;
        }

        public String getProduct() {
            return product;
        }

        public void setProduct(String product) {
            this.product = product;
        }
    }

    public CpeItem(CompositeKey id) {
        this.id = id;
        versions = new ArrayList<>();
    }

    public void AddVersion(String newVersion) {
        if (versions.stream().allMatch(version -> !version.equals(newVersion))) {
            versions.add(newVersion);
        }
    }

    public CompositeKey getId() {
        return id;
    }

    public void setId(CompositeKey id) {
        this.id = id;
    }

    public List<String> getVersions() {
        return versions;
    }

    public void setVersions(List<String> versions) {
        this.versions = versions;
    }
}
