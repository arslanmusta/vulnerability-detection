package obss.cve.vulnerableservice.repository;

import obss.cve.vulnerableservice.domain.CpeItem;
import org.springframework.data.mongodb.repository.Aggregation;
import org.springframework.data.mongodb.repository.MongoRepository;
import org.springframework.data.mongodb.repository.Query;

import java.util.List;

public interface CpeItemRepository extends MongoRepository<CpeItem, CpeItem.CompositeKey> {
    @Aggregation(pipeline = { "{ '$group': { '_id' : '$_id.vendor' } }" })
    List<String> findDistinctVendors();

    @Query("{ '_id.vendor': ?0 }")
    List<CpeItem> findAllByVendor(String vendor);
}
