package obss.cve.vulnerableservice.service;

import obss.cve.vulnerableservice.domain.CpeItem;
import obss.cve.vulnerableservice.repository.CpeItemRepository;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
public class ProductService {

    private final CpeItemRepository cpeItemRepository;

    public ProductService(CpeItemRepository cpeItemRepository) {
        this.cpeItemRepository = cpeItemRepository;
    }

    public CpeItem findOne(String vendor, String product) {
        return cpeItemRepository.findById(new CpeItem.CompositeKey(vendor, product))
                .orElseThrow(() -> new ProductNotFoundException(vendor, product));
    }

    public List<String> findAllVendors() {
        return cpeItemRepository.findDistinctVendors();
    }

    public List<CpeItem> findAllByVendor(String vendor) {
        return cpeItemRepository.findAllByVendor(vendor);
    }
}
