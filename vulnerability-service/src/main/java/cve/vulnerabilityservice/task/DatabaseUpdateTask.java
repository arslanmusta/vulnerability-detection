package cve.vulnerabilityservice.task;

import cve.vulnerabilityservice.proxy.cpe.CpeProxy;
import cve.vulnerabilityservice.proxy.cpe.model.CpeResponse;
import cve.vulnerabilityservice.proxy.cve.CveProxy;
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Component;

@Component
public class DatabaseUpdateTask {

    private final CveProxy cveProxy;
    private final CpeProxy cpeProxy;

    public DatabaseUpdateTask(CveProxy cveProxy, CpeProxy cpeProxy) {
        this.cveProxy = cveProxy;
        this.cpeProxy = cpeProxy;
    }

    @Scheduled(fixedDelayString = "${cve.update.period}")
    public void update() {
//        CveResponse cveResponse = cveProxy.GetCve("https://nvd.nist.gov/feeds/json/cve/1.1/nvdcve-1.1-modified.json.gz");

        CpeResponse cpeResponse = cpeProxy.GetCpe("https://nvd.nist.gov/feeds/xml/cpe/dictionary/official-cpe-dictionary_v2.3.xml.gz");
    }
}
