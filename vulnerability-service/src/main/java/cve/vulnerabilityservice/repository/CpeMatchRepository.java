package cve.vulnerabilityservice.repository;

import cve.vulnerabilityservice.domain.CpeMatch;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;

import java.util.Optional;

public interface CpeMatchRepository extends JpaRepository<CpeMatch, String> {
//    @Query("SELECT cm " +
//            "FROM CpeMatch cm " +
//            "WHERE " +
//            "   (:name is null or cm.name = :name) AND" +
//            "   (:versionStartIncluding is null or cm.versionStartIncluding = :versionStartIncluding) AND " +
//            "   (:versionStartExcluding is null or cm.versionStartExcluding = :versionStartExcluding) AND " +
//            "   (:versionEndIncluding is null or cm.versionEndIncluding = :versionEndIncluding) AND " +
//            "   (:versionEndExcluding is null or cm.versionEndExcluding = :versionEndExcluding)")
    Optional<CpeMatch> findByNameAndVersionStartIncludingAndVersionStartExcludingAndVersionEndIncludingAndVersionEndExcluding(
            @Param("name") String name,
            @Param("versionStartIncluding") String versionStartIncluding,
            @Param("versionStartExcluding") String versionStartExcluding,
            @Param("versionEndIncluding") String versionEndIncluding,
            @Param("versionEndExcluding") String versionEndExcluding);
}
